This repository imports and analyzes data from the [TNG simulation](https://www.tng-project.org/data/). The ROCKSTAR ([Robust Overdensity Calculation using K-Space Topologically Adaptive Refinement](https://iopscience.iop.org/article/10.1088/0004-637X/762/2/109)) halo finder is used on the simulation particle data to resolve cluster substructure from the full 6D phase space. The goal of this project is to develop methodologies that are able to identify cluster substructure from observed cluster-member galaxy dynamics ($x$, $y$, $v_z$). The three methods that are being developed/studied are:

1. The [DS+](https://github.com/josegit88/MilaDS) algorithm to find substucture using two dimensional postions and line of sight velocity. This method also includes a virial mass calculation of each substructure that is identified as well as the entire mass of the galaxy cluster. All funcitons used in this analysis are stored in the TNG_DA.py script with additional code in the DS+ folder. 

2. A Convolutional Graph Neural Network (ConvGNN) is trained on TNG300 cluster dynamics to obtain the full 6D phase space. To validate the model, data from the [BAHAMAS simulation](https://arxiv.org/abs/1603.02702) is used as out-of-distriubtion data. The full 6D phase space is then used to find the cluster substructur using a clustering algorithm called [astrolink](https://github.com/william-h-oliver/astrolink). Code for this analysis is stored in the GNN folder.

3. The full 6D phase space is found by maximizing the Shanon Entropy of a galaxy cluster. A partition function is derived using a Hamiltonian that includes the velocities and positions of each cluster-member galaxy and probabilities can then be found for galaxy to live in a particular part of phase space. Using the analytically derived probabilities and the observed cluster-member galaxy dynamics ($x$, $y$, $v_z$), the unobserved quantities can be varied in order to maximize the Shannon Entropy, thus resolving the full 6D phase space. Similar to the ConvGNN method, the cluster substructure will be found with [astrolink](https://github.com/william-h-oliver/astrolink). Code for this analysis is stored in the Entropy_Max folder.

The best of these three cluster substucture finding methods will be applied to observations from the Local Volume Complete Cluster Survey ([LoVoCCS](10.3847/1538-4357/ad67c6)) in a follow-up study. 